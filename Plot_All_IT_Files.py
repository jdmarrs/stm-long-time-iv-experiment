#===============================================================================
# Plot_All_IT_Files.py
# Python script for plotting the data from the IT Curve files that were generated by the IV Curve text files
# created by the "Tapping_IV_browser - log - 4Gfit copy - Modified for Saving IV Files.vi" LabVIEW Program.
# Iteratively calls "Plot_IT_File.py" to generate plots for each IT file in the "IT Curves" folder.
# Author: Jon Marrs
# Date: 2017-07-30
#===============================================================================

import os
import subprocess
import time

#===============================================================================
# BEGIN Configuration
#===============================================================================

# Subscript Name (Name of the script called by this script)
subscript_name = "Plot_IT_File.py"

# IT File Directory Name (Name of the directory where the IT files are relative to the script(s) location)
it_file_directory_name = "IT Curves"

#===============================================================================
# END Configuration
#===============================================================================

default_directory = os.getcwd()

print(default_directory)

it_file_directory = os.getcwd() + "\\" + it_file_directory_name

os.chdir(it_file_directory)

current_directory = os.getcwd()

print(current_directory)

parent_directory = os.listdir(os.curdir)

print(parent_directory)

print()

# Process each IT file in the directory and call the processing subscript for each IT file
for file in os.listdir():
    file_name, file_ext = os.path.splitext(file)
    
    file_amp, file_bias, file_sol, file_mc, file_rr, file_num, file_it = file_name.split('_')
    
    new_file_name = file_name.replace("IT","IT")

    # Call Python script and pass file_name as argument
    subprocess.Popen("python ../" + subscript_name + " " + str(file_name) + " " + str(new_file_name), shell=True)

    # Sleep for 1 second
    time.sleep(1)

